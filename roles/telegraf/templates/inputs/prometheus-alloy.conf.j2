# ====================================================================
# Scrape Alloy metrics for log processing statistics
# Generated by solti-monitoring/roles/telegraf
# ====================================================================

[[inputs.prometheus]]
  ## Alloy Prometheus metrics endpoint
  urls = ["http://{{ alloy_server_listen_addr | default('127.0.0.1:12345') }}/metrics"]

  ## Scrape interval (how often to collect metrics)
  interval = "60s"

  ## Timeout for HTTP requests
  timeout = "10s"

  ## Metric version (2 = use Prometheus data model)
  metric_version = 2

  ## Filter to only Alloy-specific metrics (adjust fieldpass as needed)
  ## By default, collect all metrics. Add fieldpass filters for specific metrics.
  # fieldpass = [
  #   "alloy_*",
  # ]

  ## Add tags to all metrics from this input
  [inputs.prometheus.tags]
    service = "alloy"
    collector = "telegraf"

## Notes:
## - Alloy exposes metrics at http://IP:12345/metrics (Prometheus format)
## - Telegraf converts Prometheus metrics to InfluxDB line protocol
## - Metrics are counters (always increasing), use derivative() in queries
## - Customize fieldpass array above to filter specific metrics
