# Fail2Ban Web Exploits Filter
# Author & Copyright: Mitchell Krog - mitchellkrog@gmail.com
# REPO: https://github.com/mitchellkrogza/Fail2Ban.WebExploits
# V0.1.27
# Last Updated: Tue May  8 11:08:42 SAST 2018

[Definition]


failregex = ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/\.git/config)
            ^.+?:\d+ <HOST> -.*(GET|POST).*/administrator/index\.php.*500
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/:8880/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/addons/theme/stv1/_static/image/favicon\.ico)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/addons/theme/stv1/_static/ts2/layout\.css)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/addons/theme/stv2/_static/ts2/layout\.css)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/Admin/Common/HelpLinks\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin-console)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin/inc/xml\.xslt)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/administrator/components/com_xcloner-backupandrestore/index2\.php)
        #   ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/administrator/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/administrator/manifests/files/joomla\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin/mysql2/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin/mysql/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin/phpMyAdmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin/pma/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin/PMA/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin/SouthidcEditor/ButtonImage/standard/componentmenu\.gif)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin/SouthidcEditor/Dialog/dialog\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/admin/SouthidcEditor/ewebeditor\.asp)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/API/DW/Dwplugin/SystemLabel/SiteConfig\.htm)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/API/DW/Dwplugin/TemplateManage/login_site\.htm)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/API/DW/Dwplugin/TemplateManage/manage_site\.htm)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/API/DW/Dwplugin/TemplateManage/save_template\.htm)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/API/DW/Dwplugin/ThirdPartyTags/SiteFactory\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/app/home/skins/default/style\.css)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/app/js/source/wcmlib/WCMConstants\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/apple-app-site-association)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/app/Tpl/fanwe_1/js/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/_asterisk/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/bencandy\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/blog/administrator/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/cgi-bin/php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/cgi-bin/php5)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/cgi/common\.cgi)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/CGI/Execute)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/check\.proxyradar\.com/azenv\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/ckeditor/ckfinder/ckfinder\.html)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/ckeditor/ckfinder/install\.txt)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/ckfinder/ckfinder\.html)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/ckfinder/install\.txt)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/ckupload\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/claroline/phpMyAdmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/clases\.gone\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/cms/administrator)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/command\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/components/com_adsmanager/js/fullnoconflict\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/components/com_b2jcontact/css/b2jcontact\.css)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/components/com_b2jcontact/router\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/components/com_foxcontact/js/jtext\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/components/com_sexycontactform/assets/js/index\.html)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/console/auth/reg_newuser\.jsp)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/console/include/not_login\.htm)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/console/js/CTRSRequestParam\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/console/js/CWCMDialogHead\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/currentsetting\.htm)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/CuteSoft_Client/CuteEditor/Help/default\.htm)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/CuteSoft_Client/CuteEditor/ImageEditor/listfiles\.aspx)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/CuteSoft_Client/CuteEditor/Images/log\.gif)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/data/admin/ver\.txt)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/datacenter/downloadApp/showDownload\.do)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/db/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/dbadmin/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/dbadmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/db/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/deptWebsiteAction\.do)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/eams/static/scripts/grade/course/input\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/editor/js/fckeditorcode_ie\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/examples/file-manager\.html)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/getcfg\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/get_password\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/\.git/info/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/Hello\.World)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/hndUnblock\.cgi)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/images/login9/login_33\.jpg)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/include/dialog/config\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/include/install_ocx\.aspx)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/index\.action)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/ip_js\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/issmall/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/jenkins/script)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/jm-ajax/upload_file/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/jmx-console)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/js/tools\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/libraries/sfn\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(login\.destroy\.session)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/login/Jeecms\.do)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/logo_img\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/maintlogin\.jsp)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/manager/html)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/manager/status)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/master/login\.aspx)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/media/com_hikashop/js/hikashop\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/modules/attributewizardpro/config\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/modules/columnadverts/config\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/modules/fieldvmegamenu/config\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/modules/homepageadvertise2/config\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/modules/homepageadvertise/config\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/modules/mod_simplefileuploadv1\.3/elements/udd\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/modules/pk_flexmenu/config\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/modules/pk_vertflexmenu/config\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/modules/wdoptionpanel/config\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/msd)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/msd1\.24\.4)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/msd1\.24stable)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(mstshash=NCRACK_USER)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/muieblackcat)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/myadmin2/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/myadmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/myadmin/scripts/setup\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/MyAdmin/scripts/setup\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/mysql-admin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/mysqladmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/mysqldumper)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/mySqlDumper)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/MySQLDumper)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/phpadmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/phpma/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/phpMyadmin_bak/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/phpMyAdmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/phpMyAdmin/phpMyAdmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/phpMyAdmin/scripts/setup\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/plugins/anchor/anchor\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/plugins/filemanager/filemanager/js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/plus/download\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/plus/heightsearch\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/plus/rssmap\.html)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/plus/sitemap\.html)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/pma/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/PMA/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/PMA2/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/pma/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/PMA/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/pmamy2/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/pmamy/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/pma-old/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/pma/scripts/setup\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/pmd/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/privacy\.txt)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/resources/style/images/login/btn\.png)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/Scripts/jquery/maticsoft\.jquery\.min\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/script/valid_formdata\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/siteserver/login\.aspx)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/siteserver/upgrade/default\.aspx)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(soap:Envelope)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/stalker_portal/server/adm/tv-channels/iptv-list-json)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/stalker_portal/server/adm/users/users-list-json)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/stssys\.htm)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/sys\.cache\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/system/assets/jquery/jquery-2\.x\.min\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/template/1/bluewise/_files/jspxcms\.css)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/templates/jsn_glass_pro/ext/hikashop/jsn_ext_hikashop\.css)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/test_404_page/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/test_for_404/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(Test Wuz Here)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/tmUnblock\.cgi)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/tools/phpMyAdmin/index\.ph)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/uc_server/control/admin/db\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/upload/bank-icons/)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/UserCenter/css/admin/bgimg/admin_all_bg\.png)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/\.user\.ini)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(\.bitcoin)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(wallet\.dat)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(bitcoin\.dat)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/magento2/admin)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/user/register?element_parents=account)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/user/themes/antimatter/js/antimatter\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/user/themes/antimatter/js/modernizr\.custom\.71422\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/user/themes/antimatter/js/slidebars\.min\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/w00tw00t)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/webbuilder/script/locale/wb-lang-zh_CN\.js)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/web-console)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/webdav)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/web/phpMyAdmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/whir_system/login\.aspx)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/whir_system/module/security/login\.aspx)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/wls-wsat/CoordinatorPortType)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/wpbase/url\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/wp-includes/wlwmanifest\.xml)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/wp-login\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(/www/phpMyAdmin/index\.php)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(\x00Cookie:)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(\x22cache_name_function)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(\x22JDatabaseDriverMysqli)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(\x22JSimplepieFactory)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(\x22sanitize)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(\x22SimplePie)
            ^.+?:\d+ <HOST> -.*(GET|POST|HEAD).*(\x5C0disconnectHandlers)
            ^.+?:\d+ <HOST> -.*(GET).*(\.\./wp-config.php)


ignoreregex =
